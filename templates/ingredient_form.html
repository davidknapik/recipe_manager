{% extends 'base.html' %}

{% block content %}
    {# --- The title and action of the form are now dynamic --- #}
    <h1>{% if purchase %}Edit Ingredient Purchase{% else %}Add New Ingredient Purchase{% endif %}</h1>
    
    <p>
        {% if not purchase %}
        This adds a record of a specific purchase. If the ingredient exists, it will be linked. If not, a new base ingredient will be created.
        {% endif %}
    </p>

    <form method="post">
        {# --- Each field now has a 'value' attribute to pre-fill it when editing --- #}
        
        <label for="name">Ingredient Name (e.g., Bread Flour)</label>
        <input type="text" name="name" id="name" value="{{ purchase.name if purchase else '' }}" required>
        
        <label for="store">Store (e.g., Tesco)</label>
        <input type="text" name="store" id="store" value="{{ purchase.store if purchase else '' }}" required>
        
        <label for="package_amount">Package Amount (e.g., 2, 18, 800)</label>
        <input type="number" step="any" name="package_amount" id="package_amount" value="{{ purchase.package_amount if purchase else '' }}" required>
        
        <label for="package_unit">Package Unit (e.g., kg, pack, ml)</label>
        <input type="text" name="package_unit" id="package_unit" value="{{ purchase.package_unit if purchase else '' }}" required>
        
        <label for="price">Price</label>
        <input type="number" step="0.01" name="price" id="price" value="{{ purchase.price if purchase else '' }}" required>
        
        <label for="purchase_date">Purchase Date</label>
        <input type="date" name="purchase_date" id="purchase_date" value="{{ purchase.purchase_date if purchase else '' }}" required>
        
        <label for="expiry_date">Expiration Date (Optional)</label>
        <input type="date" name="expiry_date" id="expiry_date" value="{{ purchase.expiry_date if purchase else '' }}">
        
        {# --- The button text is also dynamic --- #}
        <button type="submit">{% if purchase %}Update Purchase{% else %}Save Ingredient Purchase{% endif %}</button>
    </form>
{% endblock %}